(()=>{"use strict";class t{constructor(t){this.node=t,this.mode="primary",this.noDefault=this.node.classList.contains("video-accessibility--no-default"),this.isOneCol=this.node.classList.contains("video-accessibility--1c"),this.index=this.noDefault?0:-1,this.srt=this.node.querySelector(".video-accessibility__srt"),this.srtPrimary=this.node.querySelector(".video-accessibility__srt--primary"),this.srtSecondary=this.node.querySelector(".video-accessibility__srt--secondary"),this.primary=this.node.querySelector(".video-accessibility__media--primary"),this.secondary=this.node.querySelector(".video-accessibility__media--secondary"),this.aside=this.node.querySelector(".video-accessibility__aside"),this.asideDefault=this.node.querySelector(".video-accessibility__aside > .video-accessibility__panel"),this.panels=this.node.querySelectorAll(".video-accessibility__panels > .video-accessibility__panel"),this.controls=this.node.querySelectorAll(".video-accessibility__control > button"),this.panelControls=Array.from(this.controls).filter((t=>"panel"===t.dataset.control)),this.switchControls=Array.from(this.controls).filter((t=>"switch"===t.dataset.control)),this.activeClass="panel--active",this.gap=getComputedStyle(document.body).getPropertyValue("--wp--style--block-gap")?getComputedStyle(document.body).getPropertyValue("--wp--style--block-gap"):"2vw",setTimeout((()=>{this.controlHeight=this.node.querySelector(".video-accessibility__controls").offsetHeight,this.maxPanelHeight=`calc(${this.primary.offsetHeight}px + ${this.controlHeight}px + ${this.gap})`,this.node.style.setProperty("--vs-panel-max-height",this.maxPanelHeight)}),500),this.mediaQuery="(max-width: 781px)",this.mediaQueryList=window.matchMedia(this.mediaQuery),this.panelControls.forEach(((t,e)=>{t.addEventListener("click",(t=>{this.noDefault&&this.isOneCol||this.mediaQueryList.matches?(t.target.classList.contains("wp-block-button__link")?t.target:t.target.closest(".wp-block-button__link")).classList.contains("panel--active")?(this.panelControls[e].classList.remove(this.activeClass),this.panels[e].hidden=!0):this.goTo(e):this.noDefault?this.goTo(e===this.index?0:e):this.goTo(e===this.index?-1:e)}))})),this.node.addEventListener("click",(t=>{t.target.closest('[data-control="switch"]')&&this.switch()})),this.panelLengthCheck(),this.setMode(this.mode),this.windowActions(),this.mediaQueryList.addEventListener("change",(t=>{if(!this.mediaQueryList.matches&&this.noDefault&&!this.isOneCol){let t=!0;this.panels.forEach((e=>{e.attributes.hidden||(t=!1)})),!0===t&&this.goTo(0)}}))}windowActions(){window.addEventListener("resize",(()=>{this.controlHeight=this.node.querySelector(".video-accessibility__controls").offsetHeight,this.maxPanelHeight=`calc(${this.primary.offsetHeight}px + ${this.controlHeight}px + ${this.gap} )`,this.node.style.setProperty("--vs-panel-max-height",this.maxPanelHeight)}))}panelLengthCheck(){this.noDefault&&0===this.panels.length?(this.node.classList.remove("video-accessibility--2c"),this.aside.style.display="none"):this.noDefault&&this.isOneCol?this.panels.forEach((t=>{t.hidden=!0})):this.noDefault?this.mediaQueryList.matches?this.panels.forEach((t=>{t.hidden=!0})):this.goTo(0):this.goTo(this.index)}hideMediaNode(t){const{parentNode:e,nextSibling:i}=t;t.hidden=!0,e.removeChild(t),e.insertBefore(t,i),t.querySelectorAll("video").forEach((t=>t.pause()))}setMode(t){this.mode=t,"secondary"===this.mode?(this.secondary.removeAttribute("hidden"),this.hideMediaNode(this.primary),this.srtSecondary&&(this.srtSecondary.hidden=!1,this.srtPrimary.hidden=!0)):(this.primary.removeAttribute("hidden"),this.hideMediaNode(this.secondary),this.srtPrimary&&(this.srtPrimary.hidden=!1),this.srtSecondary&&(this.srtSecondary.hidden=!0)),this.switchControls.forEach((()=>{this.node.querySelectorAll('[data-control="switch"] .video-accessibility__control-text').forEach((t=>{let e=!1;e="secondary"===this.mode?!t.classList.contains("video-accessibility__control-text--switch"):t.classList.contains("video-accessibility__control-text--switch"),e?t.hidden=!0:t.removeAttribute("hidden")}))}))}switch(){this.setMode("primary"===this.mode?"secondary":"primary")}goTo(t){this.index=t,this.index>-1||this.noDefault?this.asideDefault.hidden=!0:this.asideDefault.removeAttribute("hidden"),this.panels.forEach(((t,e)=>{e===this.index?(this.panelControls[e].classList.add(this.activeClass),t.removeAttribute("hidden")):(this.panelControls[e].classList.remove(this.activeClass),t.hidden=!0)}))}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".video-accessibility").forEach((e=>{new t(e)}))}))})();